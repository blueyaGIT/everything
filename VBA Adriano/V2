' Module: Connect4

Dim board(6, 7) As Integer
Dim currentPlayer As Integer
Dim gameActive As Boolean

Sub InitializeGame()
    Dim i As Integer, j As Integer
    For i = 1 To 6
        For j = 1 To 7
            board(i, j) = 0
        Next j
    Next i
    currentPlayer = 1
    gameActive = True
    UpdateUI
End Sub

Sub PlayerMove(column As Integer)
    If Not gameActive Then Exit Sub
    If MakeMove(column, currentPlayer) Then
        If CheckForWin() Then
            MsgBox "Player " & currentPlayer & " wins!"
            gameActive = False
        Else
            currentPlayer = 3 - currentPlayer ' Switch player
            BotMove 1 ' Example: Bot at difficulty level 1
        End If
    End Sub
End Sub

Function MakeMove(column As Integer, player As Integer) As Boolean
    Dim row As Integer
    For row = 6 To 1 Step -1
        If board(row, column) = 0 Then
            board(row, column) = player
            UpdateUI
            MakeMove = True
            Exit Function
        End If
    Next row
    MakeMove = False
End Function

Sub BotMove(difficulty As Integer)
    Dim column As Integer
    Dim bestMove As Integer
    Dim randomChance As Single
    
    randomChance = Rnd() ' Generates a random number between 0 and 1
    bestMove = DetermineBestMove() ' Implement this function
    
    If randomChance <= difficulty * 0.1 Then
        ' Perform the best move
        MakeMove(bestMove, currentPlayer)
    Else
        ' Perform a random valid move
        Do
            column = Int(Rnd() * 7) + 1
        Loop Until MakeMove(column, currentPlayer)
    End If
    
    If CheckForWin() Then
        MsgBox "Player " & currentPlayer & " wins!"
        gameActive = False
    Else
        currentPlayer = 3 - currentPlayer ' Switch player
    End If
End Sub

Function DetermineBestMove() As Integer
    ' Implement the logic to determine the best move
    ' For simplicity, let's assume it always returns column 4
    DetermineBestMove = 4
End Function

Function SimpleStrategy() As Boolean
    Dim column As Integer
    For column = 1 To 7
        If board(1, column) = 0 Then
            board(1, column) = currentPlayer
            If CheckForWin() Then
                MakeMove(column, currentPlayer)
                SimpleStrategy = True
                board(1, column) = 0
                Exit Function
            End If
            board(1, column) = 0
        End If
    Next column
    SimpleStrategy = False
End Function

Function CheckForWin() As Boolean
    ' Check rows, columns, and diagonals for a win
    ' Implementation here
End Function

Sub UpdateUI()
    Dim i As Integer, j As Integer
    For i = 1 To 6
        For j = 1 To 7
            Cells(i, j).Value = board(i, j)
        Next j
    Next i
End Sub

Sub StartGame()
    InitializeGame
End Sub

